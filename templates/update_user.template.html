{%extends 'layout.template.html'%}

{%block title%}Update User{%endblock%}

{%block content%}
<form method='POST'>
    <h1>Update Profile</h1>
    <div>
        <label>First Name</label>
        <input type='text' name='first_name' class='form-control' value='{{selected_profile.first_name}}'/>
    </div>
    <div>
        <label>Last Name</label>
        <input type='text' name='last_name' class='form-control' value='{{selected_profile.last_name}}'/>
    </div>
    <div>
        <label>Gender</label><br>
        <input type='radio' id='male' name='gender' value='Male' {% if selected_profile.gender=='Male' %}checked{%endif%}/>
        <label for='male'>Male</label>
        <input type='radio' id='female' name='gender' value='Female'  {% if selected_profile.gender=='Female' %}checked{%endif%}/>
        <label for='female'>Female</label>
    </div>
    <div>
        <label>Date of Birth</label>
        <input id='dob' type='date' name='dob' class='form-control'  value='{{selected_profile.dob.strftime('%Y-%m-%d')}}'/>
    </div>
    <div>
        <label>Religion</label>
        <select name='religion' class='form-control'>
            <option value='Agnostic' {% if selected_profile.religion=='Agnostic'%}selected='selected'{%endif%}>Agnostic</option>
            <option value='Buddhist'{% if selected_profile.religion=='Buddhist'%}selected='selected'{%endif%}>Buddhist</option>
            <option value='Christian'{% if selected_profile.religion=='Christian'%}selected='selected'{%endif%}>Christian</option>
            <option value='Catholic'{% if selected_profile.religion=='Catholic'%}selected='selected'{%endif%}>Catholic</option>
            <option value='Hindu'{% if selected_profile.religion=='Hindu'%}selected='selected'{%endif%}>Hindu</option>
            <option value='Taoist'{% if selected_profile.religion=='Taoist'%}selected='selected'{%endif%}>Taoist</option>
            <option value='Free Thinker'{% if selected_profile.religion=='Free Thinker'%}selected='selected'{%endif%}>Free Thinker</option>
        </select>
    </div>
    <div>
        <label>Height (cm)</label>
        <input type='number' name='height' class='form-control'  value='{{selected_profile.height}}'/>
    </div>
    <div>
        <label>Languages</label><br>
        <input type='checkbox' class='languages_checkbox' id='English' name='language'{%for i in selected_profile.languages%}{%if i=='English'%}checked{%endif%}{%endfor%}/>
        <label for='English'>English</label>
        <input type='checkbox' class='languages_checkbox' id='Chinese' name='language'{%for i in selected_profile.languages%}{%if i=='Chinese'%}checked{%endif%}{%endfor%}/>
        <label for='Chinese'>Chinese</label>
        <input type='checkbox' class='languages_checkbox' id='Tamil' name='language'{%for i in selected_profile.languages%}{%if i=='Tamil'%}checked{%endif%}{%endfor%}/>
        <label for='Tamil'>Tamil</label>
        <input type='checkbox' class='languages_checkbox' id='Malay' name='language'{%for i in selected_profile.languages%}{%if i=='Malay'%}checked{%endif%}{%endfor%}/>
        <label for='Malay'>Malay</label>
    </div>
    <div>
        <label>Self Summary</label>
        <input type='text' name='summary' class='form-control' value='{{selected_profile.self_summary}}'/>
    </div>
    <div>
        Profile Picture<br>
        <a id="upload_widget" class="cloudinary-button">Upload Image</a>
        <input type="hidden" id="uploaded_file_url" name="uploaded_file_url"/>
        <br/>
        <img id="uploaded-image" src='{{selected_profile.picture_url}}'>
    </div>

    <input type='submit' value='Update Details'/>
</form>
{%endblock%}

{%block js%}
<script src="https://widget.cloudinary.com/v2.0/global/all.js" type="text/javascript"></script>  

<script type="text/javascript">  
var myWidget = cloudinary.createUploadWidget({
  cloudName: '{{cloud_name}}', 
  uploadPreset: '{{upload_preset}}'}, (error, result) => { 
    if (!error && result && result.event === "success") { 
      console.log('Done! Here is the image info: ', result.info); 
      document.querySelector('#uploaded_file_url').value=result.info.url
      document.querySelector('#uploaded-image').src=result.info.thumbnail_url
    }
  }
)

document.getElementById("upload_widget").addEventListener("click", function(){
    myWidget.open();
  }, false);

</script>
{%endblock%}